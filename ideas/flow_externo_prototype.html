<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Flow Externo ‚Äî Prot√≥tipo</title>
    <link rel="stylesheet" href="style_flow_externo.css" />
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <header class="topbar">
        <div class="brand">Improov ‚Äî <strong>Flow Externo</strong></div>
        <div class="search"> <input placeholder="Buscar entregas, arquivos..." aria-label="Buscar" /> </div>
        <div class="actions">
            <button class="btn" aria-label="Notifica√ß√µes">
                <span class="ico">üîî</span>
                <span class="vis">Notifica√ß√µes</span>
            </button>
            <div class="avatar">C</div>
        </div>
    </header>

    <div class="app">
        <!-- <aside class="sidebar">
            <nav>
                <ul>
                    <li class="active">Vis√£o Geral</li>
                    <li>Entregas</li>
                    <li>Calend√°rio</li>
                    <li>Arquivos</li>
                    <li>Atividades</li>
                    <li>Configura√ß√µes</li>
                </ul>
            </nav>
        </aside> -->

        <main class="main">
            <section class="kpis">
                <div class="kpi">
                    <div class="kpi-title">Entregas Hoje</div>
                    <div class="kpi-value" data-target="15">0</div>
                </div>
                <div class="kpi">
                    <div class="kpi-title">Atrasadas</div>
                    <div class="kpi-value kpi-danger" data-target="4">0</div>
                </div>
                <div class="kpi">
                    <div class="kpi-title">Em Revis√£o</div>
                    <div class="kpi-value kpi-warn" data-target="25">0</div>
                </div>
                <div class="kpi">
                    <div class="kpi-title">Pr√≥ximos 7 dias</div>
                    <div class="kpi-value" data-target="18">0</div>
                </div>
            </section>

            <section class="filters">
                <div class="filter-chips">
                    <button class="chip">Todos</button>
                    <button class="chip">Em Revis√£o</button>
                    <button class="chip">Atrasado</button>
                    <button class="chip">Conclu√≠do</button>
                </div>
                <div class="actions-row">
                    <!-- <button class="btn ghost">Filtro</button>
                    <button class="btn primary">Novo Upload</button> -->
                </div>
            </section>

            <section class="cards">
                <article class="card" data-status-code="R00" data-images-total="5" data-images-delivered="3">
                    <img class="thumb" src="../assets/07_HSA_MON_Hall de Entrada_EF.jpg" alt="preview" />
                    <div class="card-body">
                        <h3>R00</h3>
                        <div class="meta">Entrega: 15/11</div>
                        <div class="status-row">
                            <span class="status-code">R00</span>
                            <span class="img-count">3/5 imagens</span>
                        </div>
                        <div class="progress">
                            <div data-pct="60" style="width:60%"></div>
                            <div class="progress-percent">60%</div>
                        </div>
                        <div class="tags">
                            <span class="badge warn">Em Revis√£o</span>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="btn small" title="Comentar">
                            <span class="ico">üí¨</span>
                            Comentar
                        </button>
                        <button class="btn small" title="Aprovar">
                            <span class="ico">‚úîÔ∏è</span>
                            Aprovar
                        </button>
                    </div>
                </article>

                <article class="card" data-status-code="P00" data-images-total="4" data-images-delivered="4">
                    <img class="thumb" src="../assets/25_CAP_TIV_LivingSacada_AptoTipo2_EF.jpg" alt="preview" />
                    <div class="card-body">
                        <h3>P00</h3>
                        <div class="meta">Entrega: 10/11</div>
                        <div class="status-row">
                            <span class="status-code">P00</span>
                            <span class="img-count">4/4 imagens</span>
                        </div>
                        <div class="progress">
                            <div data-pct="100" style="width:100%"></div>
                            <div class="progress-percent">100%</div>
                        </div>
                        <div class="tags">
                            <span class="badge success">Conclu√≠do</span>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="btn small" title="Ver">
                            <span class="ico">üëÅÔ∏è</span>
                            Ver
                        </button>
                        <button class="btn small" title="Baixar">
                            <span class="ico">‚¨áÔ∏è</span>
                            Baixar
                        </button>
                    </div>
                </article>

                <article class="card" data-status-code="R01" data-images-total="8" data-images-delivered="1">
                    <img class="thumb" src="../assets/07_HSA_MON_Hall de Entrada_EF.jpg" alt="preview" />
                    <div class="card-body">
                        <h3>R01</h3>
                        <div class="meta">Entrega: 18/11</div>
                        <div class="status-row">
                            <span class="status-code">R01</span>
                            <span class="img-count">1/8 imagens</span>
                        </div>
                        <div class="progress">
                            <div data-pct="12" style="width:12%"></div>
                            <div class="progress-percent">12%</div>
                        </div>
                        <div class="tags">
                            <span class="badge muted">N√£o iniciado</span>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="btn small" title="Comentar">
                            <span class="ico">üí¨</span>
                            Comentar
                        </button>
                    </div>
                </article>
            </section>

        </main>

        <!-- <aside class="rightcol">
            <div class="calendar">
                <h4>Calend√°rio</h4>
            </div>

            <div class="activity">
                <h4>√öltimas Atividades</h4>
                <ul>
                    <li>Jo√£o carregou <strong>Banner Campanha</strong></li>
                    <li>Ana comentou em <strong>Logo Animado</strong></li>
                    <li>Pedro marcou <strong>V√≠deo</strong> como pronto</li>
                </ul>
            </div>

            <div class="upload-quick">
                <h4>Upload R√°pido</h4>
                <div class="drop">Arraste arquivos ou clique para anexar</div>
            </div>
        </aside> -->
    </div>

    <footer class="footer">Legenda: <span class="badge success">Conclu√≠do</span> <span class="badge warn">Revis√£o</span>
        <span class="badge danger">Atrasado</span>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // ajustar barras de progresso com base em atributos data
            document.querySelectorAll('.card').forEach(function (card) {
                var total = parseInt(card.dataset.imagesTotal || 0, 10);
                var delivered = parseInt(card.dataset.imagesDelivered || 0, 10);
                var pct = 0;
                if (total > 0) pct = Math.round((delivered / total) * 100);
                var bar = card.querySelector('.progress > div');
                if (bar) {
                    // anima a largura
                    setTimeout(function () { bar.style.width = pct + '%'; }, 80);
                    bar.setAttribute('aria-valuenow', pct);
                }
                var pctEl = card.querySelector('.progress-percent');
                if (pctEl) pctEl.textContent = pct + '%';
                var imgCount = card.querySelector('.img-count');
                if (imgCount) imgCount.textContent = delivered + '/' + total + ' imagens';
                var statusCodeEl = card.querySelector('.status-code');
                if (statusCodeEl && card.dataset.statusCode) statusCodeEl.textContent = card.dataset.statusCode;
            });

            // anima KPIs simples
            function animateKPI(el) {
                var target = parseInt(el.dataset.target || el.textContent || 0, 10);
                var start = 0;
                var duration = 700;
                var startTime = null;
                function step(ts) {
                    if (!startTime) startTime = ts;
                    var progress = Math.min((ts - startTime) / duration, 1);
                    el.textContent = Math.floor(progress * target + (1 - progress) * start);
                    if (progress < 1) requestAnimationFrame(step);
                }
                requestAnimationFrame(step);
            }
            document.querySelectorAll('.kpi .kpi-value').forEach(function (el) { animateKPI(el); });

            // inicializa FullCalendar (b√°sico)
            var calendarEl = document.getElementById('calendar');
            if (calendarEl) {
                var calendar = new FullCalendar.Calendar(calendarEl, {
                    initialView: 'dayGridMonth',
                    height: 320,
                    headerToolbar: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'dayGridMonth,dayGridWeek'
                    },
                    events: [
                        { title: 'Logo Animado ‚Äî Entrega', start: new Date().toISOString().slice(0, 10) },
                        { title: 'Banner Campanha ‚Äî Revis√£o', start: new Date(new Date().getTime() + 3 * 24 * 60 * 60 * 1000).toISOString().slice(0, 10) }
                    ]
                });
                calendar.render();
            }
        });
    </script>
</body>

</html>